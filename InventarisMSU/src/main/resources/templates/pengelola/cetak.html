<!DOCTYPE html>
<html lang="id" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title th:text="'Bukti Peminjaman - ' + ${peminjaman.borrowerName}">Cetak Bukti</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link rel="icon" th:href="@{/assets/guest/loogoo.png}">
	<style>
		body {
			font-family: "Times New Roman", Times, serif;
			color: #000;
			background-color: #fff;
			/* White background for print preview */
			font-size: 12pt;
		}

		.container {
			max-width: 800px;
			margin: 0 auto;
			padding: 40px;
			background: #fff;
		}

		/* HEADER SURAT */
		.kop-surat {
			border-bottom: 3px solid #000;
			padding-bottom: 10px;
			margin-bottom: 30px;
			display: flex;
			align-items: center;
			justify-content: center;
			gap: 20px;
		}

		.kop-logo {
			width: 80px;
			height: auto;
		}

		.kop-text {
			text-align: center;
			line-height: 1.2;
		}

		.kop-instansi {
			font-size: 14pt;
			font-weight: bold;
			text-transform: uppercase;
		}

		.kop-sub {
			font-size: 12pt;
		}

		.kop-contact {
			font-size: 10pt;
			margin-top: 5px;
		}

		/* JUDUL */
		.judul-surat {
			text-align: center;
			margin-bottom: 30px;
		}

		.judul-teks {
			font-size: 14pt;
			font-weight: bold;
			text-decoration: underline;
			text-transform: uppercase;
		}

		/* TABEL */
		.table-custom {
			width: 100%;
			border-collapse: collapse;
			margin-top: 20px;
			margin-bottom: 20px;
		}

		.table-custom th,
		.table-custom td {
			border: 1px solid #000;
			padding: 8px 12px;
			text-align: left;
		}

		.table-custom th {
			text-align: center;
			font-weight: bold;
			background-color: #f0f0f0 !important;
			/* Ensure background prints if enabled, usually browsers strip it but gray is okay */
		}

		/* SIGNATURE */
		.signature-section {
			display: flex;
			justify-content: space-between;
			margin-top: 60px;
			page-break-inside: avoid;
		}

		.signature-box {
			text-align: center;
			width: 250px;
		}

		.sign-space {
			height: 80px;
		}

		/* NON-PRINT */
		@media print {
			@page {
				size: A4;
				margin: 2cm;
			}

			body {
				margin: 0;
				background-color: #fff;
			}

			.no-print {
				display: none !important;
			}

			.container {
				width: 100%;
				max-width: none;
				padding: 0;
				margin: 0;
				box-shadow: none;
				border: none;
			}
		}

		.info-table td {
			padding: 4px 0;
			vertical-align: top;
		}

		.info-label {
			width: 150px;
			font-weight: bold;
		}

		.info-sep {
			width: 20px;
			text-align: center;
		}
	</style>
</head>

<body>
	<!-- TOMBOL AKSI UTILS -->
	<div class="container no-print text-center mb-4">
		<div class="alert alert-info">
			Halaman ini siap dicetak. Gunakan tombol di bawah ini.
		</div>
		<button onclick="window.print()" class="btn btn-primary btn-lg rounded-pill px-5 shadow">
			<i class="bi bi-printer me-2"></i>Cetak Dokumen
		</button>
		<button onclick="window.close()" class="btn btn-secondary btn-lg rounded-pill px-5 shadow ms-2">
			Tutup
		</button>
	</div>

	<div class="container shadow-sm border receipt-card">
		<!-- KOP SURAT -->
		<header class="kop-surat">
			<img th:src="@{/assets/guest/loogoo.png}" alt="Logo" class="kop-logo" />
			<div class="kop-text">
				<div class="kop-instansi">MASJID SYAMSUL ULUM</div>
				<div class="kop-sub">Telkom University, Bandung, Jawa Barat</div>
				<div class="kop-contact">Email: msu@telkomuniversity.ac.id | Web: msu.telkomuniversity.ac.id</div>
			</div>
		</header>

		<!-- JUDUL -->
		<div class="judul-surat">
			<div class="judul-teks">BUKTI PERSETUJUAN PEMINJAMAN</div>
			<div class="mt-1">Nomor: MSU/LOAN/<span
					th:text="${#temporals.format(peminjaman.startDate, 'yyyy')}"></span>/<span
					th:text="${#numbers.formatInteger(peminjaman.id, 4)}"></span></div>
		</div>

		<!-- ISI -->
		<div class="content">
			<p>Dengan ini menerangkan bahwa permohonan peminjaman ruangan/barang yang diajukan oleh:</p>

			<table class="info-table mb-4">
				<tr>
					<th scope="row" class="info-label">Nama Peminjam</th>
					<td class="info-sep">:</td>
					<td th:text="${peminjaman.borrowerName}">Nama Lengkap</td>
				</tr>
				<tr>
					<th scope="row" class="info-label">Unit / Dept</th>
					<td class="info-sep">:</td>
					<td th:text="${peminjaman.department}">Departemen</td>
				</tr>
				<tr>
					<th scope="row" class="info-label">Tanggal Pengajuan</th>
					<td class="info-sep">:</td>
					<td th:text="${#temporals.format(peminjaman.startDate, 'dd MMMM yyyy')}">Tanggal</td>
				</tr>
				<tr>
					<th scope="row" class="info-label">Status</th>
					<td class="info-sep">:</td>
					<td>
						<span
							style="border: 2px solid #000; padding: 2px 8px; font-weight: bold; text-transform: uppercase;"
							th:text="${#strings.toString(peminjaman.status) == 'APPROVED' ? 'DISETUJUI' : (#strings.toString(peminjaman.status) == 'REJECTED' ? 'DITOLAK' : peminjaman.status)}">APPROVED</span>
					</td>
				</tr>
				<tr>
					<th scope="row" class="info-label">Keperluan</th>
					<td class="info-sep">:</td>
					<td th:text="${peminjaman.reason}">Acara</td>
				</tr>
			</table>

			<p>Detail barang atau ruangan yang diizinkan untuk dipinjam adalah sebagai berikut:</p>

			<table class="table-custom">
				<thead>
					<tr>
						<th style="width: 50px;">No</th>
						<th>Nama Barang / Ruangan</th>
						<th style="width: 100px;">Jumlah</th>
					</tr>
				</thead>
				<tbody>
					<tr th:each="detail, iterStat : ${peminjaman.details}">
						<td class="text-center" th:text="${iterStat.count}">1</td>
						<td th:text="${detail.item.name}">Nama Item</td>
						<td class="text-center" th:text="${detail.quantity} + ' unit'">1 unit</td>
					</tr>
				</tbody>
			</table>

			<div class="mt-4">
				<strong>Catatan Tambahan:</strong>
				<ul class="mt-2" style="list-style-type: disc; padding-left: 20px;">
					<li>Tanggal Peminjaman: <span
							th:text="${#temporals.format(peminjaman.startDate, 'dd-MM-yyyy')}"></span></li>
					<li>Tanggal Pengembalian: <span
							th:text="${#temporals.format(peminjaman.endDate, 'dd-MM-yyyy')}"></span></li>
					<li>Jam Mulai: <span th:text="${peminjaman.startTime} + ' WIB'"></span></li>
					<li>Durasi Pinjam: <span th:text="${peminjaman.duration} + ' Jam'"></span></li>
					<li>Jam Pengembalian: <span th:text="${peminjaman.endTime} + ' WIB'"></span></li>
				</ul>
			</div>

			<p class="mt-4">Demikian bukti ini dibuat untuk dapat dipergunakan sebagaimana mestinya.</p>
		</div>

		<!-- TANDA TANGAN -->
		<div class="signature-section">
			<div class="signature-box">
				<p>Peminjam,</p>
				<div class="sign-space"></div>
				<p style="font-weight: bold; text-decoration: underline;" th:text="${peminjaman.borrowerName}">( Nama
					Peminjam )</p>
			</div>
			<div class="signature-box">
				<p>Bandung, <span th:text="${#temporals.format(#temporals.createNow(), 'dd MMMM yyyy')}">Tanggal
						Sekarang</span></p>
				<p>Pengelola MSU,</p>
				<div class="sign-space">
					<!-- Optional: Image signature -->
					<!-- <img th:src="@{/assets/pengelola/aset/ttd_cap.png}" style="height: 80px; opacity: 0.8;" alt="TTD"> -->
				</div>
				<p style="font-weight: bold; text-decoration: underline;">Admin Pengelola</p>
			</div>
		</div>
	</div>
</body>

</html>