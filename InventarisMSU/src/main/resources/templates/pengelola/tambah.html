<!DOCTYPE html>
<html lang="id" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pengelola MSU — Tambah Barang/Ruangan</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap">
  <link rel="icon" th:href="@{/assets/guest/loogoo.png}">

  <style>
    body {
      background: #ffffff;
      font-family: "Inter", sans-serif;
    }

    .shadow-soft {
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08),
        0 2px 4px rgba(0, 0, 0, 0.04);
    }

    .shadow-strong {
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12),
        0 4px 8px rgba(0, 0, 0, 0.08);
    }

    .navbar-nav .nav-link {
      color: #2fa16c;
      font-weight: 600;
      margin: 0 10px;
      transition: color 0.2s;
    }

    .navbar-nav .nav-link:hover {
      color: #0b492c;
    }

    .navbar-nav .nav-link.active {
      color: #0b492c !important;
    }

    .title-bar {
      letter-spacing: 0.06em;
      color: #2a6a55;
    }

    .form-card {
      border-radius: 22px;
    }

    .pill {
      border-radius: 9999px;
    }

    .btn-msu {
      background: #0b492c;
      border-color: #0b492c;
    }

    .btn-msu:hover {
      filter: brightness(0.95);
    }

    .label-muted {
      font-size: 0.95rem;
      color: #56616b;
    }

    .help {
      font-size: 0.8rem;
      color: #6c757d;
    }

    .preview {
      height: 360px;
      object-fit: cover;
      border-radius: 18px;
    }

    @media (max-width: 991.98px) {
      .preview {
        height: 240px;
      }
    }

    .dropdown-toggle.pill {
      border: 1px solid #0b492c;
      color: #0b492c;
      background: #fff;
    }

    .dropdown-toggle.pill:hover {
      background: #f5fbf7;
      color: #0b492c;
    }

    .dropdown-menu {
      border-radius: 14px;
      border: 1px solid #0b492c;
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.1);
    }

    .dropdown-item {
      border-radius: 10px;
    }

    .dropdown-item.active,
    .dropdown-item:hover {
      background: #e9f6ef;
      color: #0b492c;
    }

    input.form-control:focus,
    textarea.form-control:focus,
    select.form-select:focus,
    .dropdown-toggle:focus {
      border-color: #000;
      box-shadow: none;
      outline: 0;
    }
  </style>
</head>

<body>
  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg fixed-top shadow-soft bg-white">
    <div class="container">
      <a class="navbar-brand" th:href="@{/pengelola/beranda}">
        <img th:src="@{/assets/guest/loogoo.png}" alt="Logo MSU" style="height: 45px" />
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navmenu">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navmenu">
        <ul class="navbar-nav mb-2 mb-lg-0">
          <li class="nav-item">
            <a class="nav-link" th:href="@{/pengelola/beranda}">Beranda</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" th:href="@{/pengelola/laporan}">Laporan</a>
          </li>
          <li class="nav-item">
            <a class="nav-link active" aria-current="page" th:href="@{/pengelola/tambah}">Tambah Barang</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" th:href="@{/pengelola/approval}">Approval</a>
          </li>
        </ul>

        <!-- USER DROPDOWN + LOGOUT (SAMA FORMATNYA) -->
        <div class="ms-3 dropdown">
          <button class="btn btn-outline-secondary d-flex align-items-center rounded-pill px-3 py-1 border-0"
            type="button" id="userMenuButtonTambah" data-bs-toggle="dropdown" aria-expanded="false">
            <img id="userAvatar" th:src="@{/assets/guest/loogoo.png}" alt="User" class="rounded-circle me-2" width="32"
              height="32" />
            <div class="text-start">
              <div id="userName" class="fw-semibold text-dark small">
                Pengelola
              </div>
              <div id="userRoleLabel" class="text-muted" style="font-size: 0.75rem">
                Pengelola Side
              </div>
            </div>
            <i class="bi bi-chevron-down ms-2 small"></i>
          </button>

          <ul class="dropdown-menu dropdown-menu-end mt-2">
            <li>
              <button class="dropdown-item text-danger" id="btnLogout" type="button"
                onclick="window.location.href='/logout';">
                <i class="bi bi-box-arrow-right me-2"></i>Keluar
              </button>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </nav>
  <div style="height: 84px"></div>

  <!-- HEADER -->
  <section class="container text-center mb-4">
    <p class="mb-1 title-bar fw-semibold">
      PENAMBAHAN BARANG/RUANGAN
    </p>
    <h2 class="fw-bolder text-uppercase" style="color: #32435a">
      Masjid Syamsul Ulum
    </h2>
    <div class="mx-auto" style="
          width: 120px;
          height: 3px;
          background: #2a6a55;
          border-radius: 2px;
        "></div>
  </section>

  <!-- FORM SECTION -->
  <section class="container pb-5">
    <div class="row g-4 align-items-stretch">
      <!-- LEFT: FOTO -->
      <div class="col-12 col-lg-5">
        <div class="card form-card shadow-strong h-100">
          <div class="card-body">
            <h5 class="mb-3">Foto Barang/Ruangan</h5>
            <img id="imgPreview" class="w-100 preview mb-3"
              src="https://images.unsplash.com/photo-1520975922219-830a99aa20a6?q=80&w=1600&auto=format&fit=crop"
              alt="Preview" />
            <div class="d-grid gap-2">
              <label class="btn btn-outline-secondary pill">
                <i class="bi bi-upload me-2"></i>Pilih Foto
                <input id="fileInput" name="imageFile" type="file" form="formTambah" class="d-none" accept="image/*" />
              </label>
              <small class="help">Format JPG/PNG, maksimal ±5MB. Gunakan foto
                terang agar jelas di katalog.</small>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: FORM -->
      <div class="col-12 col-lg-7">
        <div class="card form-card shadow-strong h-100">
          <div class="card-body">
            <h5 class="text-center fw-bold mb-4">
              Form Pendaftaran
            </h5>

            <!-- FORM SUDAH TERHUBUNG BACKEND -->
            <form id="formTambah" class="row g-3 needs-validation" novalidate method="post"
              th:action="@{/pengelola/tambah}" enctype="multipart/form-data">
              <!-- Nama -->
              <div class="col-12">
                <label class="form-label label-muted" for="inpNama">Nama*</label>
                <input id="inpNama" name="name" type="text" class="form-control pill"
                  placeholder="Contoh: Proyektor / Ruang Tamu VIP" required />
                <div class="invalid-feedback">
                  Nama wajib diisi.
                </div>
              </div>

              <!-- Kategori -->
              <div class="col-12">
                <label class="form-label label-muted" for="btnKategori">Kategori*</label>
                <div class="dropdown">
                  <button class="btn dropdown-toggle pill w-100 text-start" type="button" data-bs-toggle="dropdown"
                    aria-expanded="false" id="btnKategori">
                    Pilih kategori
                  </button>
                  <ul class="dropdown-menu w-100" aria-labelledby="btnKategori">
                    <li>
                      <a class="dropdown-item" href="#" data-value="BARANG">Barang</a>
                    </li>
                    <li>
                      <a class="dropdown-item" href="#" data-value="RUANGAN">Ruangan</a>
                    </li>
                  </ul>
                </div>

                <!-- ini yang dibaca backend: name="type" -->
                <input type="hidden" id="inpKategori" name="type" required />
                <div class="invalid-feedback">
                  Pilih kategori terlebih dahulu.
                </div>
              </div>

              <!-- Deskripsi -->
              <div class="col-12">
                <label class="form-label label-muted" for="inpDesk">Deskripsi</label>
                <textarea id="inpDesk" name="description" class="form-control" rows="3" style="border-radius: 18px"
                  placeholder="Spesifikasi singkat / aturan penggunaan (opsional)"></textarea>
                <small class="help">Disarankan 15–200 karakter.</small>
              </div>

              <!-- Status -->
              <div class="col-12 col-md-6">
                <label class="form-label label-muted" for="inpStatus">Status</label>
                <select id="inpStatus" name="status" class="form-select pill">
                  <option value="Tersedia" selected>
                    Tersedia
                  </option>
                  <option value="Tidak Tersedia">
                    Tidak Tersedia
                  </option>
                  <option value="Perawatan">
                    Perawatan
                  </option>
                </select>
              </div>

              <!-- Stok / Kapasitas -->
              <div class="col-12 col-md-6" id="wrapStok" style="display: none">
                <label class="form-label label-muted" for="inpStok">Stok*</label>
                <input id="inpStok" type="number" min="0" class="form-control pill" placeholder="Contoh: 10" />
                <div class="invalid-feedback">
                  Stok wajib diisi untuk kategori Barang.
                </div>
              </div>

              <div class="col-12 col-md-6" id="wrapKapasitas" style="display: none">
                <label class="form-label label-muted" for="inpKapasitas">Kapasitas*</label>
                <div class="input-group">
                  <input id="inpKapasitas" type="number" min="1" class="form-control pill" placeholder="Contoh: 100" />
                  <span class="input-group-text pill">orang</span>
                </div>
                <div class="invalid-feedback">
                  Kapasitas wajib diisi untuk kategori
                  Ruangan.
                </div>
              </div>

              <!-- hidden stock yang dikirim ke backend -->
              <input type="hidden" id="stockHidden" name="stock" value="0" />
              <!-- hidden capacity yang dikirim ke backend -->
              <input type="hidden" id="capacityHidden" name="capacity" value="0" />

              <!-- Aksi -->
              <div class="col-12 d-flex justify-content-end pt-2">
                <button type="reset" class="btn btn-outline-secondary pill px-4 me-2">
                  Bersihkan
                </button>
                <button type="submit" class="btn btn-msu text-white pill px-4">
                  <i class="bi bi-check2-circle me-1"></i>Daftar
                </button>
              </div>

              <!-- alert sukses (optional) -->
              <div id="alertSukses" class="alert alert-success d-none mt-2 mb-0" role="alert">
                Data berhasil disimpan.
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Kamu boleh tetap pakai file ini, tapi di bawah aku tulis FULLCODE JS-nya (copy ke tambah.js) -->
  <script th:src="@{/assets/pengelola/tambah.js}"></script>

  <script>
    // fallback kalau tambah.js belum ada / belum diupdate
    // (kalau tambah.js kamu sudah diisi full sesuai bawah, script ini aman karena event sama)
  </script>
</body>

</html>